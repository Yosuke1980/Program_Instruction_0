ラジオ番組スケジュール抽出システム要件まとめ（最終版）
基本情報

システム: スタンドアロンGAS（Google Apps Script）
データソース:

番組スケジュールスプレッドシート（メイン）
Googleカレンダー（収録予定）


処理方針: 読み取り専用、ログ出力のみ

スプレッドシート構造
シート名形式

yy.m.dd-m.dd（例：25.1.27-2.02）
月曜日から次の日曜日までの週単位

データ範囲特定ルール

RSマーカー: 備考列の「RS」文字列で曜日を区切り
月曜: 1つ目RS行 〜 2つ目RS行の直前
火曜: 2つ目RS行 〜 3つ目RS行の直前
水曜: 3つ目RS行 〜 4つ目RS行の直前
木曜: 4つ目RS行 〜 5つ目RS行の2行前
金曜: 5つ目RS行 〜 "THE BURN"行の直前
土曜: "THE BURN"行の次 〜 "まんてん"行の直前
日曜: "まんてん"行の次 〜 "注意："行の直前

エラー処理

RS行が5個未満の場合：金土日のみ抽出

抽出対象番組
平日番組（月〜木）

ちょうどいいラジオ: 時間帯番組名に含まれる
PRIME TIME: 時間帯番組名に含まれる

金曜番組

FLAG: 金曜専用番組名に含まれる

土曜番組

God Bless Saturday: 土曜専用番組名に含まれる
Route 847: 土曜専用番組名に含まれる

データ構造化仕様
番組別カテゴリ構成
ちょうどいいラジオ:

日付、7:28パブ告知、時間指定なし告知、YOKOHAMA PORTSIDE INFORMATION、楽曲、先行予約、ゲスト、ラジオショッピング、はぴねすくらぶ
月間収録予定（曜日と並列）：

ちょうどいい暮らし収録予定
ここが知りたい不動産収録予定
ちょうどいい歯ッピー収録予定
ちょうどいいおカネの話収録予定
ちょうどいいごりごり隊収録予定
ビジネスアイ収録予定



PRIME TIME:

日付、19:41Traffic、19:43、20:51、営業コーナー、指定曲、ゲスト、時間指定なしパブ、ラジショピ、先行予約・限定予約

FLAG:

日付、12:40 電話パブ、13:29 パブリシティ、13:40 パブリシティ、12:15 リポート案件、14:29 リポート案件、時間指定なし告知、楽曲、先行予約、ゲスト

God Bless Saturday:

日付、楽曲、14:41パブ、時間指定なしパブ

Route 847:

日付、リポート 16:47、営業パブ 17:41、時間指定なし告知、楽曲

特殊データ処理ルール
日付処理

算出方法: シート名から月曜日を抽出し、各曜日を自動計算
形式: 文字列形式"m/d"
配置: 各曜日データの最初の要素

楽曲処理

分割: ♪マーカーで楽曲を分離
清浄化: ♪マーク、数字（半角・全角）、丸囲み数字を削除
対象文字: 0-9、０-９、①②③...⑳、⑴⑵⑶...⒇、㈠㈡㈢...㈩

備考列データ処理

ラジオショッピング: RS:で始まる文字列、プレフィックス削除
はぴねすくらぶ: HC:で始まる文字列、プレフィックス削除

空データ処理

デフォルト値: ["ー"]で埋める

Googleカレンダー連携
検索仕様

検索期間: シート開始日から90日後まで
取得件数: 各番組最大2件
並び順: 開始日に近い順